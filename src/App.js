aW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7CmltcG9ydCAnLi9BcHAuY3NzJzsKaW1wb3J0IEJvYXJkIGZyb20gJy4vY29tcG9uZW50cy9Cb2FyZCc7CmltcG9ydCB7IGdlbmVyYXRlU3Vkb2t1LCBzb2x2ZVN1ZG9rdSB9IGZyb20gJy4vc3Vkb2t1U29sdmVyJzsKCmZ1bmN0aW9uIEFwcCgpIHsKICBjb25zdCBbaW5pdGlhbEJvYXJkLCBzZXRJbml0aWFsQm9hcmRdID0gdXNlU3RhdGUobnVsbCk7CiAgY29uc3QgW2JvYXJkLCBzZXRCb2FyZF0gPSB1c2VTdGF0ZShudWxsKTsKICBjb25zdCBbc29sdmVkQm9hcmQsIHNldFNvbHZlZEJvYXJkJyAgPSB1c2VTdGF0ZShudWxsKTsKCiAgdXNlRWZmZWN0KCgpID0+IHsKICAgIGlmICghaW5pdGlhbEJvYXJkKSB7CiAgICAgIGNvbnN0IHsgcGxhdGUsIHNvbHZlZCA9IGdlbmVyYXRlU3Vkb2t1KCkgfTsKICAgICAgc2V0SW5pdGlhbEJvYXJkKHBsYXRlKTsKICAgICAgc2V0Qm9hcmQocGxhdGUpOwogICAgICBzZXRTb2x2ZWRCb2FyZChzb2x2ZWQpOwogICAgfQogIH0sIFtpbml0aWFsQm9hcmRdKTsKCiAgY29uc3QgaGFuZGxlQ2VsbENoYW5nZSA9IChyb3csIGNvbCwgdmFsdWUpID0+IHsKICAgIGNvbnN0IG5ld0JvYXJkID0gYm9hcmQubWFwKChyZWZyb3cscikgPT4KICAgICAgcmVmcm93Lm1hcCgoY2VsbHZhbHVlLGQpID0+IHIgPT09IHJvdyAmJiBkID09PSBjb2wgPyB2YWx1ZSA6IGNlbGx2YWx1ZSkKICAgICk7CiAgICBzZXRCb2FyZChuZXdCb2FyZCk7CiAgfTsKCiAgY29uc3QgaGFuZGxlUmVzZXQgPSAoKSA9PiB7CiAgICBjb25zdCB7IHBsYXRlLCBzb2x2ZWQgfSA9IGdlbmVyYXRlU3Vkb2t1KCk7CiAgICBzZXRJbml0aWFsQm9hcmQocGxhdGUpOwogICAgc2V0Qm9hcmQocGxhdGUpOwogICAgc2V0U29sdmVkQm9hcmQoc29sdmVkKTsKICB9OwogIAogIGNvbnN0IGhhbmRsZVNvbHZlID0gKCkgPT4gewogICAgaWYgKHNvbHZlZEJvYXJkKSB7CiAgICAgIHNldEJvYXJkKHNvbHZlZEJvYXJkKTsKICAgIH0KICB9OwogIAogIHJldHVybiAoCiAgICA8ZGl2IGNsYXNzTmFtZT1cIkFwcFwiPgogICAgICA8aDE+U3Vkb2t1IEFwcDwvaDE+CiAgICAgIHttaW5pdGlhbEJvYXJkJzAmJzxCb2FyZCBib2FyZD17Ym9hcmR9IGluaXRpYWxCb2FyZD17aW5pdGlhbEJvYXJkfSBvbkNhbGxDaGFuZ2U9e2hhbmRsZUNlbGxDaGFuZ2V9IC8+fQogICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRyb2xzXCI+CiAgICAgICAgPGJ1dHRvbiBvbkClick={handleReset}>TmV3IEdhbWU8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e2hhbmRsZVNvbHZlfT5Tb2x2ZTwvYnV0dG9uPgogICAgICA8L2RpdiAKICAgIDwvZGl2PgogICk7Cn0KZXhwb3J0IGRlZmF1bHQgQXBwOwo=